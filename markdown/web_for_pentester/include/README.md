# 文件包含笔记



1. **包含**

   > 开发人员通常会把重复使用的函数写到单个文件中，使用时直接调用此文件，而无需再次编写，这种**调用文件的过程一般称为包含。**
   >
   > 服务器执行PHP文件时，可以通过文件包含函数加载另一个文件中的PHP代码，并且当PHP来执行，这会为开发者节省大量的时间。这意味着您可以创建供所有网页引用的标准页眉或菜单文件。当页眉需要更新时，您只更新一个包含文件就可以了，或者当您向网站添加一张新页面时，仅仅需要修改一下菜单文件（而不是更新所有网页中的链接）。

2. **PHP中文件包含的函数**

   > - **include()**：找不到被包含文件，报错，但会继续运行脚本；
   >   .
   > - **include_once()**：与include（）类似，区别在于，当重复调用同一文件时，程序只调用一次；
   >   .
   > - **require()**：找不到被包含文件，报错，并且停止运行脚本；
   >   .
   > - **require_once()** ：与require类似，区别在于，当重复调用同一文件时，程序只调用一次；
   >
   > .
   > `include_once()`和`require_once()`这两个函数只包含一次，适用于在脚本执行期想确保它只被包括一次以避免函数重定义，变量重新赋值等问题。
   >
   > 只要使用上面几个函数不管是以什么为后缀的文件，都会当做php文件去执行，如果有php代码就会执行php代码，如果没有就会打印文件不是php代码的内容

3. **利用漏洞的条件**

   > 1. 文件包含的函数通过动态变量的方式引用需要包含的文件
   > 2. 用户能够控制该动态变量
   > 3. 被包含的文件可以访问

4. **文件包含还分有远程包含和本地包含**

   > 1. **远程包含**
   >
   >    > 如果PHP的配置选项 `allow url include`为ON的话,则 include/require函数是可以加载远程文件的,这种漏洞被称为**远程文件包含漏洞( Remote File Inclusion,简称RFI)**。
   >    >
   >    > 如果远程文件没经过严格的过滤，导致了执行恶意文件的代码，这就是远程文件包含漏洞。
   >    >
   >    > **允许远程文件包含的配置文件修改内容**
   >    >
   >    > - `allow_url_fopen` = On（是否允许打开远程文件)
   >    > - `allow_url_include` = On（是否允许include/require远程文件）
   >
   > 2. **本地包含**
   >
   >    > 能够打开并包含本地文件的漏洞,被称为**本地文件包含漏洞( Local file inclusion,简称LFI)**.比如下面这段代码,就存在LFI漏洞.